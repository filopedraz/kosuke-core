# ðŸ“‹ Ticket 13.5: Enhanced Project Creation with GitHub Integration

**Priority:** High
**Estimated Effort:** 4 hours
**Dependencies:** Ticket 13 (Next.js GitHub Integration Routes)

## Description

Transform the existing project creation flow to include mandatory GitHub integration with a sleek tab-based interface. Users can either create a new project (which creates a new GitHub repository) or import an existing GitHub repository.

## Files to Create/Update

```
app/(logged-in)/projects/components/project-creation-modal.tsx (major update)
hooks/use-projects.ts (update create function)
hooks/use-project-creation.ts (new)
components/github/repository-selector.tsx (new)
components/github/repository-preview.tsx (new)
lib/types/github.ts (extend)
lib/types/projects.ts (extend)
lib/utils/string-helpers.ts (new)
```

## Implementation Details

### **lib/utils/string-helpers.ts** - String utility functions:

```typescript
/**
 * Converts a project name to dash-case for GitHub repository naming
 * Examples: "My Awesome Project" -> "my-awesome-project"
 */
export function toDashCase(str: string): string {
  return str
    .toLowerCase()
    .trim()
    .replace(/[^\w\s-]/g, '') // Remove special characters
    .replace(/\s+/g, '-') // Replace spaces with dashes
    .replace(/-+/g, '-') // Replace multiple dashes with single dash
    .replace(/^-|-$/g, ''); // Remove leading/trailing dashes
}

/**
 * Validates GitHub repository name
 */
export function isValidRepoName(name: string): boolean {
  return /^[a-zA-Z0-9._-]+$/.test(name) && name.length > 0 && name.length <= 100;
}

/**
 * Formats repository name for display
 */
export function formatRepoName(name: string): string {
  return name
    .toLowerCase()
    .replace(/[^a-z0-9-]/g, '-')
    .replace(/-+/g, '-');
}
```

### **lib/types/projects.ts** - Extended project types:

```typescript
// Extend existing project types
export interface CreateProjectData {
  name: string;
  prompt: string;
  github: {
    type: 'create' | 'import';
    repositoryName?: string; // For create mode
    repositoryUrl?: string; // For import mode
    description?: string;
    isPrivate?: boolean;
  };
}

export interface ProjectCreationStep {
  step: 'project-details' | 'github-setup' | 'creating' | 'complete';
  data?: Partial<CreateProjectData>;
  error?: string;
}
```

### **lib/types/github.ts** - Extended GitHub types:

```typescript
// Extend existing GitHub types with repository selection
export interface GitHubRepositoryOption {
  id: number;
  name: string;
  full_name: string;
  description: string | null;
  private: boolean;
  html_url: string;
  language: string | null;
  stargazers_count: number;
  updated_at: string;
  owner: {
    login: string;
    avatar_url: string;
  };
}

export interface RepositoryCreationConfig {
  name: string;
  description?: string;
  private: boolean;
  auto_init: boolean;
  gitignore_template?: string;
  license_template?: string;
}

export interface ProjectGitHubSettings {
  repositoryName: string;
  description: string;
  isPrivate: boolean;
  autoInit: boolean;
}
```

### **hooks/use-project-creation.ts** - Enhanced creation logic:

```typescript
import { useState } from 'react';
import { useMutation, useQueryClient } from '@tanstack/react-query';
import { useRouter } from 'next/navigation';
import { useToast } from '@/hooks/use-toast';
import type { CreateProjectData, ProjectCreationStep } from '@/lib/types/projects';
import type { Project } from '@/lib/db/schema';
import type { ApiResponse } from '@/lib/api';

export function useProjectCreation() {
  const [currentStep, setCurrentStep] = useState<ProjectCreationStep>({
    step: 'project-details',
  });
  const queryClient = useQueryClient();
  const router = useRouter();
  const { toast } = useToast();

  const createProjectMutation = useMutation({
    mutationFn: async (data: CreateProjectData): Promise<Project> => {
      setCurrentStep({ step: 'creating', data });

      const response = await fetch('/api/projects', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({}));
        throw new Error(errorData.error || 'Failed to create project');
      }

      const result: ApiResponse<{ project: Project }> = await response.json();
      return result.data.project;
    },
    onSuccess: project => {
      setCurrentStep({ step: 'complete', data: currentStep.data });
      queryClient.invalidateQueries({ queryKey: ['projects'] });

      toast({
        title: 'Project Created',
        description: `Successfully created ${project.name} with GitHub integration.`,
      });

      // Navigate after a brief delay to show success state
      setTimeout(() => {
        router.replace(`/projects/${project.id}`);
      }, 1000);
    },
    onError: error => {
      setCurrentStep({
        step: 'project-details',
        data: currentStep.data,
        error: error.message,
      });

      toast({
        title: 'Failed to Create Project',
        description: error.message,
        variant: 'destructive',
      });
    },
  });

  const resetCreation = () => {
    setCurrentStep({ step: 'project-details' });
  };

  return {
    currentStep,
    setCurrentStep,
    createProject: createProjectMutation.mutate,
    isCreating: createProjectMutation.isPending,
    resetCreation,
  };
}
```

### **components/github/repository-selector.tsx** - GitHub repository dropdown:

```typescript
'use client';

import { Check, ChevronDown, Github, Lock, Star } from 'lucide-react';
import { useState } from 'react';

import { Button } from '@/components/ui/button';
import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
} from '@/components/ui/command';
import { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';
import { Skeleton } from '@/components/ui/skeleton';
import { useGitHubRepositories } from '@/hooks/use-github-repositories';
import type { GitHubRepositoryOption } from '@/lib/types/github';
import { cn } from '@/lib/utils';

interface RepositorySelectorProps {
  userId: string;
  selectedRepository?: GitHubRepositoryOption;
  onRepositorySelect: (repository: GitHubRepositoryOption) => void;
  placeholder?: string;
}

export function RepositorySelector({
  userId,
  selectedRepository,
  onRepositorySelect,
  placeholder = 'Select a repository...',
}: RepositorySelectorProps) {
  const [open, setOpen] = useState(false);
  const { data: repositories, isLoading } = useGitHubRepositories(userId);

  if (isLoading) {
    return <RepositorySelectorSkeleton />;
  }

  return (
    <Popover open={open} onOpenChange={setOpen}>
      <PopoverTrigger asChild>
        <Button
          variant="outline"
          role="combobox"
          aria-expanded={open}
          className="w-full justify-between h-11"
        >
          {selectedRepository ? (
            <div className="flex items-center gap-3">
              <Github className="h-4 w-4 text-muted-foreground" />
              <div className="flex flex-col items-start">
                <span className="font-medium">{selectedRepository.name}</span>
                {selectedRepository.description && (
                  <span className="text-xs text-muted-foreground truncate max-w-[200px]">
                    {selectedRepository.description}
                  </span>
                )}
              </div>
            </div>
          ) : (
            <span className="text-muted-foreground">{placeholder}</span>
          )}
          <ChevronDown className="ml-2 h-4 w-4 shrink-0 opacity-50" />
        </Button>
      </PopoverTrigger>
      <PopoverContent className="w-[400px] p-0">
        <Command>
          <CommandInput placeholder="Search repositories..." />
          <CommandList>
            <CommandEmpty>No repositories found.</CommandEmpty>
            <CommandGroup>
              {repositories?.map((repo) => (
                <CommandItem
                  key={repo.id}
                  value={repo.name}
                  onSelect={() => {
                    onRepositorySelect(repo);
                    setOpen(false);
                  }}
                  className="p-3"
                >
                  <div className="flex items-center justify-between w-full">
                    <div className="flex items-center gap-3 flex-1 min-w-0">
                      <Github className="h-4 w-4 text-muted-foreground shrink-0" />
                      <div className="flex flex-col min-w-0 flex-1">
                        <div className="flex items-center gap-2">
                          <span className="font-medium truncate">{repo.name}</span>
                          {repo.private && <Lock className="h-3 w-3 text-muted-foreground" />}
                        </div>
                        {repo.description && (
                          <span className="text-xs text-muted-foreground truncate">
                            {repo.description}
                          </span>
                        )}
                        <div className="flex items-center gap-3 mt-1">
                          {repo.language && (
                            <span className="text-xs bg-muted px-2 py-1 rounded">
                              {repo.language}
                            </span>
                          )}
                          {repo.stargazers_count > 0 && (
                            <div className="flex items-center gap-1 text-xs text-muted-foreground">
                              <Star className="h-3 w-3" />
                              {repo.stargazers_count}
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                    <Check
                      className={cn(
                        'ml-2 h-4 w-4 shrink-0',
                        selectedRepository?.id === repo.id ? 'opacity-100' : 'opacity-0'
                      )}
                    />
                  </div>
                </CommandItem>
              ))}
            </CommandGroup>
          </CommandList>
        </Command>
      </PopoverContent>
    </Popover>
  );
}

function RepositorySelectorSkeleton() {
  return (
    <div className="space-y-2">
      <Skeleton className="h-11 w-full" />
      <div className="text-xs text-muted-foreground">
        Loading your repositories...
      </div>
    </div>
  );
}
```

### **components/github/repository-preview.tsx** - Repository configuration preview:

```typescript
'use client';

import { Github, Lock, Globe } from 'lucide-react';

import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import type { ProjectGitHubSettings } from '@/lib/types/github';

interface RepositoryPreviewProps {
  settings: ProjectGitHubSettings;
  mode: 'create' | 'import';
  repositoryUrl?: string;
}

export function RepositoryPreview({ settings, mode, repositoryUrl }: RepositoryPreviewProps) {
  return (
    <Card className="border-dashed">
      <CardHeader className="pb-3">
        <CardTitle className="flex items-center gap-2 text-sm">
          <Github className="h-4 w-4" />
          {mode === 'create' ? 'New Repository' : 'Import Repository'}
        </CardTitle>
        <CardDescription>
          {mode === 'create'
            ? 'A new GitHub repository will be created with these settings'
            : 'This repository will be imported to your project'
          }
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-3">
        <div className="flex items-center justify-between">
          <div className="space-y-1">
            <div className="flex items-center gap-2">
              <span className="font-medium">{settings.repositoryName}</span>
              <Badge variant={settings.isPrivate ? 'secondary' : 'outline'} className="text-xs">
                {settings.isPrivate ? (
                  <>
                    <Lock className="h-3 w-3 mr-1" />
                    Private
                  </>
                ) : (
                  <>
                    <Globe className="h-3 w-3 mr-1" />
                    Public
                  </>
                )}
              </Badge>
            </div>
            {settings.description && (
              <p className="text-sm text-muted-foreground">{settings.description}</p>
            )}
          </div>
        </div>

        {mode === 'import' && repositoryUrl && (
          <div className="pt-2 border-t">
            <a
              href={repositoryUrl}
              target="_blank"
              rel="noopener noreferrer"
              className="text-xs text-blue-600 hover:text-blue-800 hover:underline"
            >
              View on GitHub â†’
            </a>
          </div>
        )}
      </CardContent>
    </Card>
  );
}
```

### **app/(logged-in)/projects/components/project-creation-modal.tsx** - Enhanced modal with tabs:

```tsx
'use client';

import { FolderPlus, Github, Loader2, ArrowRight, Settings } from 'lucide-react';
import { useEffect, useState } from 'react';
import { useUser } from '@clerk/nextjs';

import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Checkbox } from '@/components/ui/checkbox';
import { Dialog, DialogContent, DialogDescription, DialogTitle } from '@/components/ui/dialog';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Textarea } from '@/components/ui/textarea';
import { RepositorySelector } from '@/components/github/repository-selector';
import { RepositoryPreview } from '@/components/github/repository-preview';
import { useProjectCreation } from '@/hooks/use-project-creation';
import type { GitHubRepositoryOption, ProjectGitHubSettings } from '@/lib/types/github';
import type { CreateProjectData } from '@/lib/types/projects';
import { toDashCase, isValidRepoName } from '@/lib/utils/string-helpers';

interface ProjectCreationModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  initialProjectName?: string;
  prompt?: string;
}

export default function ProjectCreationModal({
  open,
  onOpenChange,
  initialProjectName = '',
  prompt = '',
}: ProjectCreationModalProps) {
  const { user } = useUser();
  const [activeTab, setActiveTab] = useState<'create' | 'import'>('create');
  const [projectName, setProjectName] = useState(initialProjectName);
  const [projectPrompt, setProjectPrompt] = useState(prompt);

  // Create mode state
  const [githubSettings, setGithubSettings] = useState<ProjectGitHubSettings>({
    repositoryName: '',
    description: '',
    isPrivate: false,
    autoInit: true,
  });

  // Import mode state
  const [selectedRepository, setSelectedRepository] = useState<GitHubRepositoryOption>();

  const { currentStep, createProject, isCreating, resetCreation } = useProjectCreation();

  // Auto-generate repository name from project name
  useEffect(() => {
    if (activeTab === 'create' && projectName) {
      const repoName = toDashCase(projectName);
      setGithubSettings(prev => ({ ...prev, repositoryName: repoName }));
    }
  }, [projectName, activeTab]);

  // Reset form when modal opens/closes
  useEffect(() => {
    if (open) {
      resetCreation();
      setProjectName(initialProjectName);
      setProjectPrompt(prompt);
      setSelectedRepository(undefined);
      setActiveTab('create');
    }
  }, [open, initialProjectName, prompt, resetCreation]);

  // Close modal on successful creation
  useEffect(() => {
    if (currentStep.step === 'complete') {
      setTimeout(() => {
        onOpenChange(false);
      }, 1500);
    }
  }, [currentStep.step, onOpenChange]);

  const handleCreateProject = () => {
    if (!projectName.trim()) return;

    const createData: CreateProjectData = {
      name: projectName.trim(),
      prompt: projectPrompt || projectName.trim(),
      github: {
        type: activeTab,
        ...(activeTab === 'create'
          ? {
              repositoryName: githubSettings.repositoryName,
              description: githubSettings.description,
              isPrivate: githubSettings.isPrivate,
            }
          : {
              repositoryUrl: selectedRepository?.html_url,
            }),
      },
    };

    createProject(createData);
  };

  const canSubmit = () => {
    if (!projectName.trim()) return false;

    if (activeTab === 'create') {
      return isValidRepoName(githubSettings.repositoryName);
    } else {
      return !!selectedRepository;
    }
  };

  const getSubmitText = () => {
    if (isCreating) {
      if (currentStep.step === 'creating') {
        return activeTab === 'create' ? 'Creating Project...' : 'Importing Project...';
      }
    }
    return activeTab === 'create' ? 'Create Project' : 'Import Project';
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="sm:max-w-[600px] p-0 overflow-hidden border border-border bg-card shadow-lg rounded-md">
        <DialogTitle className="sr-only">
          {activeTab === 'create' ? 'Create New Project' : 'Import from GitHub'}
        </DialogTitle>
        <DialogDescription className="sr-only">
          {activeTab === 'create'
            ? 'Create a new project with a GitHub repository'
            : 'Import an existing GitHub repository as a project'}
        </DialogDescription>

        <div className="p-6">
          <div className="flex items-center space-x-3 mb-6">
            <FolderPlus className="h-5 w-5 text-primary" />
            <h3 className="text-lg font-semibold">New Project</h3>
          </div>

          <Tabs
            value={activeTab}
            onValueChange={value => setActiveTab(value as 'create' | 'import')}
            className="w-full"
          >
            <TabsList className="w-full mb-6">
              <TabsTrigger value="create" className="flex items-center gap-2 flex-1">
                <FolderPlus className="h-4 w-4" />
                <span>Create New</span>
              </TabsTrigger>
              <TabsTrigger value="import" className="flex items-center gap-2 flex-1">
                <Github className="h-4 w-4" />
                <span>Import from GitHub</span>
              </TabsTrigger>
            </TabsList>

            <div className="space-y-6">
              {/* Project Name - Common for both tabs */}
              <div className="space-y-2">
                <Label htmlFor="projectName" className="text-sm font-medium">
                  Project Name
                </Label>
                <Input
                  id="projectName"
                  value={projectName}
                  onChange={e => setProjectName(e.target.value)}
                  className="h-11"
                  placeholder="My awesome project"
                  disabled={isCreating}
                />
              </div>

              <TabsContent value="create" className="space-y-6 mt-0">
                <Card>
                  <CardHeader className="pb-4">
                    <CardTitle className="flex items-center gap-2 text-base">
                      <Settings className="h-4 w-4" />
                      GitHub Repository Settings
                    </CardTitle>
                    <CardDescription>
                      Configure the GitHub repository that will be created for your project.
                    </CardDescription>
                  </CardHeader>
                  <CardContent className="space-y-4">
                    <div className="space-y-2">
                      <Label htmlFor="repoName" className="text-sm font-medium">
                        Repository Name
                      </Label>
                      <Input
                        id="repoName"
                        value={githubSettings.repositoryName}
                        onChange={e =>
                          setGithubSettings(prev => ({
                            ...prev,
                            repositoryName: e.target.value,
                          }))
                        }
                        className="h-10 font-mono text-sm"
                        placeholder="my-awesome-project"
                        disabled={isCreating}
                      />
                      <p className="text-xs text-muted-foreground">
                        Repository name will be used in the GitHub URL
                      </p>
                    </div>

                    <div className="space-y-2">
                      <Label htmlFor="repoDescription" className="text-sm font-medium">
                        Description (Optional)
                      </Label>
                      <Textarea
                        id="repoDescription"
                        value={githubSettings.description}
                        onChange={e =>
                          setGithubSettings(prev => ({
                            ...prev,
                            description: e.target.value,
                          }))
                        }
                        className="min-h-[80px] resize-none"
                        placeholder="A brief description of your project..."
                        disabled={isCreating}
                      />
                    </div>

                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="private-repo"
                        checked={githubSettings.isPrivate}
                        onCheckedChange={checked =>
                          setGithubSettings(prev => ({
                            ...prev,
                            isPrivate: !!checked,
                          }))
                        }
                        disabled={isCreating}
                      />
                      <Label htmlFor="private-repo" className="text-sm">
                        Make repository private
                      </Label>
                    </div>
                  </CardContent>
                </Card>

                {projectName && githubSettings.repositoryName && (
                  <RepositoryPreview settings={githubSettings} mode="create" />
                )}
              </TabsContent>

              <TabsContent value="import" className="space-y-6 mt-0">
                <Card>
                  <CardHeader className="pb-4">
                    <CardTitle className="flex items-center gap-2 text-base">
                      <Github className="h-4 w-4" />
                      Select Repository
                    </CardTitle>
                    <CardDescription>
                      Choose an existing GitHub repository to import into your project.
                    </CardDescription>
                  </CardHeader>
                  <CardContent>
                    <div className="space-y-2">
                      <Label className="text-sm font-medium">GitHub Repository</Label>
                      <RepositorySelector
                        userId={user?.id || ''}
                        selectedRepository={selectedRepository}
                        onRepositorySelect={setSelectedRepository}
                        placeholder="Search and select a repository..."
                      />
                    </div>
                  </CardContent>
                </Card>

                {selectedRepository && (
                  <RepositoryPreview
                    settings={{
                      repositoryName: selectedRepository.name,
                      description: selectedRepository.description || '',
                      isPrivate: selectedRepository.private,
                      autoInit: false,
                    }}
                    mode="import"
                    repositoryUrl={selectedRepository.html_url}
                  />
                )}
              </TabsContent>

              {/* Error Display */}
              {currentStep.error && (
                <Card className="border-destructive/50 bg-destructive/5">
                  <CardContent className="pt-4">
                    <p className="text-sm text-destructive">{currentStep.error}</p>
                  </CardContent>
                </Card>
              )}

              {/* Actions */}
              <div className="flex justify-end items-center gap-3 pt-4 border-t">
                <Button
                  variant="ghost"
                  onClick={() => onOpenChange(false)}
                  disabled={isCreating}
                  className="h-10"
                >
                  Cancel
                </Button>
                <Button
                  onClick={handleCreateProject}
                  disabled={!canSubmit() || isCreating}
                  className="h-10 space-x-2 min-w-[140px]"
                >
                  {isCreating ? (
                    <>
                      <Loader2 className="h-4 w-4 animate-spin" />
                      <span>{getSubmitText()}</span>
                    </>
                  ) : (
                    <>
                      <span>{getSubmitText()}</span>
                      <ArrowRight className="h-4 w-4" />
                    </>
                  )}
                </Button>
              </div>
            </div>
          </Tabs>
        </div>
      </DialogContent>
    </Dialog>
  );
}
```

### **hooks/use-projects.ts** - Updated create function:

```typescript
// Update the existing useCreateProject hook to handle the new data structure

export function useCreateProject() {
  const queryClient = useQueryClient();
  const router = useRouter();

  return useMutation<Project, Error, CreateProjectData>({
    mutationFn: async (requestData: CreateProjectData) => {
      const response = await fetch('/api/projects', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(requestData),
      });

      if (!response.ok) {
        const errorData = await response.json().catch(() => ({}));
        throw new Error(errorData.error || 'Failed to create project');
      }

      const responseData = await response.json();
      const project = responseData.data?.project || responseData.project || responseData;

      if (!project || !project.id) {
        throw new Error('Invalid project data received from server');
      }

      return {
        ...project,
        createdAt: new Date(project.createdAt),
        updatedAt: new Date(project.updatedAt),
      };
    },
    onSuccess: data => {
      queryClient.invalidateQueries({ queryKey: ['projects'] });
      queryClient.invalidateQueries({ queryKey: ['github-repositories'] });

      setTimeout(() => {
        router.replace(`/projects/${data.id}`);
      }, 100);
    },
    onError: error => {
      console.error('Failed to create project:', error);
    },
  });
}
```

## API Route Updates

### **app/api/projects/route.ts** - Enhanced to handle GitHub integration:

```typescript
// Update the existing POST handler to process the new CreateProjectData structure
export async function POST(request: NextRequest) {
  try {
    const { userId } = auth();
    if (!userId) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const body: CreateProjectData = await request.json();
    const { name, prompt, github } = body;

    // Validate required fields
    if (!name?.trim()) {
      return NextResponse.json({ error: 'Project name is required' }, { status: 400 });
    }

    if (!github || !github.type) {
      return NextResponse.json({ error: 'GitHub integration is required' }, { status: 400 });
    }

    // Start transaction for atomic operations
    const project = await db.transaction(async tx => {
      // Create project first
      const [newProject] = await tx
        .insert(projects)
        .values({
          name: name.trim(),
          prompt: prompt || name.trim(),
          clerkUserId: userId,
        })
        .returning();

      // Create or import GitHub repository
      if (github.type === 'create') {
        // Create new repository
        const repoResult = await fetch(`${process.env.AGENT_SERVICE_URL}/api/github/create-repo`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-GitHub-Token': await getGitHubToken(userId),
          },
          body: JSON.stringify({
            name: github.repositoryName,
            description: github.description,
            private: github.isPrivate,
            auto_init: true,
          }),
        });

        if (!repoResult.ok) {
          throw new Error('Failed to create GitHub repository');
        }

        const repoData = await repoResult.json();

        // Update project with GitHub info
        await tx
          .update(projects)
          .set({
            githubRepoUrl: repoData.html_url,
            githubOwner: repoData.owner.login,
            githubRepoName: repoData.name,
            lastGithubSync: new Date(),
          })
          .where(eq(projects.id, newProject.id));
      } else if (github.type === 'import') {
        // Import existing repository
        const importResult = await fetch(
          `${process.env.AGENT_SERVICE_URL}/api/github/import-repo`,
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'X-GitHub-Token': await getGitHubToken(userId),
            },
            body: JSON.stringify({
              repo_url: github.repositoryUrl,
              project_id: newProject.id,
            }),
          }
        );

        if (!importResult.ok) {
          throw new Error('Failed to import GitHub repository');
        }

        const repoInfo = await importResult.json();

        // Update project with GitHub info
        await tx
          .update(projects)
          .set({
            githubRepoUrl: github.repositoryUrl,
            githubOwner: repoInfo.owner,
            githubRepoName: repoInfo.name,
            lastGithubSync: new Date(),
          })
          .where(eq(projects.id, newProject.id));
      }

      return newProject;
    });

    return NextResponse.json({
      data: { project },
      message: 'Project created successfully with GitHub integration',
    });
  } catch (error) {
    console.error('Error creating project:', error);
    return NextResponse.json(
      { error: error instanceof Error ? error.message : 'Internal server error' },
      { status: 500 }
    );
  }
}
```

## Acceptance Criteria

- [x] Tab-based interface matching settings design
- [x] Create new projects with automatic GitHub repository creation
- [x] Import existing GitHub repositories as projects
- [x] Repository name auto-generation in dash-case
- [x] Repository selector with search and preview
- [x] Atomic operations (project creation fails if GitHub fails)
- [x] GitHub integration mandatory for all new projects
- [x] Real-time repository name validation
- [x] Proper loading states and error handling
- [x] Repository privacy settings
- [x] Integration with existing project management hooks

## ðŸŽ¯ Summary

This ticket transforms the project creation experience with:

**ðŸŽ¨ Enhanced UI/UX:**

- Beautiful tab interface matching settings design
- Smooth transitions and loading states
- Repository previews and validation
- Searchable repository selector

**ðŸ”— GitHub Integration:**

- Mandatory GitHub connection for all new projects
- Dual-mode: Create new or import existing repositories
- Auto-generated repository names in dash-case
- Repository privacy and description settings

**ðŸ’ª Robust Implementation:**

- Atomic operations ensuring data consistency
- Comprehensive error handling and recovery
- Type-safe implementation throughout
- Integration with existing TanStack Query patterns

**ðŸš€ Benefits:**
âœ… Streamlined project creation with GitHub
âœ… Consistent design language across the app
âœ… Bulletproof error handling and validation
âœ… Future-ready architecture for additional integrations
